---
# handlers file for sonarqube
  - name: Restart Sonarqube
    systemd:
      name: sonarqube
      state: restarted
      daemon_reload: True
      enabled: True
    notify: Wait for Sonarqube
    become: True

  - name: Wait for Sonarqube
    uri:
      url: '{{ item }}'
      follow_redirects: all
      return_content: True
    register: uri_result
    until: "'Loading...' in uri_result.content"
    retries: 12
    delay: 5
    loop:
      - '{{ sonar_check_url }}'
      - '{{ sonar_check_url }}/about'
      
