---
# defaults file for sonarqube

sonar_major_version: 7
sonar_minor_version: 2.1

sonar_path: "/opt/sonarqube"
sonar_user: "sonar"
sonar_group: "sonar"

# Tuning
sonar_nofile: 65536
sonar_nproc: 2048
sonar_log_level: "INFO"
sonar_java_opts:
  web: "-Xmx512m -Xms128m"
  es: "-Xms512m -Xmx512m"
  ce: "-Xmx512m -Xms128m"

# sonarqube web interface
# should be covered reverse proxy
web:
  host: "0.0.0.0"
  port: 9000
  path: "/"

# database connection
sonar_db:
  type: "postgresql"
  port: 5432
  host: "localhost"
  name: "sonar"
  user: "sonar"
  password: "sonar"
  options: ""

# Since 7.1 mysql deprecated
#  type: "mysql"
#  port: 3306
#  host: "localhost"
#  name: "sonar"
#  user: "sonar"
#  password: "sonar"
#  options: "?useUnicode=true&\
#            characterEncoding=utf8&\
#            rewriteBatchedStatements=true&\
#            useConfigs=maxPerformance&\
#            useSSL=false"

# sonarqube artifact provider
sonar_store: "https://binaries.sonarsource.com/Distribution/sonarqube"
# local download path
download_path: "/tmp/"

sonar_proxy:
  type: "nginx"
# type: "apache"
  port: 443
  ssl: True
  ssl_cert_path: "/etc/pki/tls/certs/{{ ansible_hostname }}.ca-cert.pem"
  ssl_key_path: "/etc/pki/tls/private/{{ ansible_hostname }}.ca-pkey.pem"
  client_max_body_size: "32m"

sonar_optional_plugins: []

# Optional plugins.
#  - "https://binaries.sonarsource.com/Distribution/sonar-auth-github-plugin/\
#    sonar-auth-github-plugin-1.3.jar"
#  - "https://github.com/QualInsight/qualinsight-plugins-sonarqube-smell/releases/download/\
#    qualinsight-plugins-sonarqube-smell-4.0.0/qualinsight-sonarqube-smell-plugin-4.0.0.jar"
#  - "https://github.com/QualInsight/qualinsight-plugins-sonarqube-badges/releases/download/\
#    qualinsight-plugins-sonarqube-badges-3.0.1/qualinsight-sonarqube-badges-3.0.1.jar"
#  - "https://github.com/racodond/sonar-json-plugin/releases/download/2.3/\
#    sonar-json-plugin-2.3.jar"
#  - "https://github.com/SonarSource/sonar-auth-bitbucket/releases/download/1.0/\
#    sonar-auth-bitbucket-plugin-1.0.jar"
#    you have to build this plugin manually after role is installed, use "mvn clean install" command
#  - "https://github.com/mibexsoftware/sonar-bitbucket-plugin/archive/\
#    v1.2.3.zip"
#  - "https://github.com/RIGS-IT/sonar-xanitizer/releases/download/1.5.0/\
#    sonar-xanitizer-plugin-1.5.0.jar"
#  - "https://github.com/gabrie-allaigre/sonar-gitlab-plugin/releases/download/3.0.1/\
#    sonar-gitlab-plugin-3.0.1.jar"
#  - "https://github.com/gabrie-allaigre/sonar-auth-gitlab-plugin/releases/download/1.3.2/\
#    sonar-auth-gitlab-plugin-1.3.2.jar"
#  - "https://binaries.sonarsource.com/Distribution/sonar-css-plugin/\
#    sonar-css-plugin-1.0.2.611.jar"
#  - "https://binaries.sonarsource.com/Distribution/sonar-kotlin-plugin/\
#    sonar-kotlin-plugin-1.1.0.1552.jar"

sonar_exclude_plugins:

# Exclude plugins that goes with SonarQube installation:
# 1. if there is newer version in sonar_plugins list in vars/main.yml
# 2. if you don't need it
  - "sonarqube-{{ sonar_major_version }}.{{ sonar_minor_version }}\
    /extensions/plugins/sonar-java-plugin-5.4.0.14284.jar"
  - "sonarqube-{{ sonar_major_version }}.{{ sonar_minor_version }}\
    /extensions/plugins/sonar-javascript-plugin-4.1.0.6085.jar"
  - "sonarqube-{{ sonar_major_version }}.{{ sonar_minor_version }}\
    /extensions/plugins/sonar-typescript-plugin-1.7.0.2893.jar"
