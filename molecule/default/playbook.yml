---
- name: Converge
  hosts: all
  vars:
    sonar_db:
      type: "H2"
      port: ""
      host: ""
      name: ""
      user: ""
      password: ""
      options: ""
  roles:
    - role: ansible-role-java
    - role: ansible-role-sonarqube
  post_tasks:
    - name: "start sonarqube"
      service: 
        name: "sonarqube"
        state: "started"
      ignore_errors: True
    - name: print to stdout
      command: systemctl status sonarqube
      register: status
    - debug: msg="{{ status.stdout }}"
    - name: "verify sonarqube"
      uri:
        url: "http://localhost:9000"
